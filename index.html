<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Calendar Reminder Generator</title>

<style>
  body {
    font-family: system-ui, -apple-system, sans-serif;
    max-width: 600px;
    margin: auto;
    padding: 20px;
  }

  h2 {
    text-align: center;
  }

  label {
    display: block;
    margin-top: 12px;
    font-weight: 600;
  }

  input, textarea, button {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    font-size: 16px;
    box-sizing: border-box;
  }

  textarea {
    resize: vertical;
  }

  .buttons {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 20px;
  }

  .full {
    grid-column: 1 / -1;
  }

  #qrcode {
    text-align: center;
    margin-top: 25px;
  }

  #qrcode img {
    margin-top: 10px;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 8px;
  }

  footer {
    margin-top: 40px;
    text-align: center;
    font-size: 13px;
    opacity: 0.6;
  }
</style>
</head>

<body>

<h2>üìÖ Calendar Reminder</h2>

<form id="eventForm">

<label>Event Title
<input id="title" required>
</label>

<label>Start
<input type="datetime-local" id="start" required>
</label>

<label>End
<input type="datetime-local" id="end" required>
</label>

<label>Location
<input id="location">
</label>

<label>Description
<textarea id="description"></textarea>
</label>

<label>Reminder (minutes before)
<input type="number" id="reminder" value="15" min="0">
</label>

<div class="buttons">
  <button class="full" type="submit">üì• Download (.ICS)</button>
  <button type="button" onclick="openGoogle()">üìÖ Google</button>
  <button type="button" onclick="downloadICS()">üçé Apple / Outlook</button>
  <button type="button" onclick="makeQR()">üî≥ Generate QR</button>
  <button type="button" onclick="downloadQR()">‚¨áÔ∏è Download QR</button>
  <button class="full" type="button" onclick="shareEvent()">üì§ Share Event</button>
</div>

</form>

<div id="qrcode"></div>

<footer>
  Free static calendar generator
</footer>

<script>

function formatICS(date) {
  return new Date(date).toISOString().replace(/[-:]/g,"").split(".")[0] + "Z";
}

function getEventData() {
  return {
    title: document.getElementById("title").value,
    start: formatICS(document.getElementById("start").value),
    end: formatICS(document.getElementById("end").value),
    location: document.getElementById("location").value,
    description: document.getElementById("description").value,
    reminder: document.getElementById("reminder").value
  };
}

function buildICS(e) {
  return `BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
BEGIN:VEVENT
UID:${Date.now()}@calendar
DTSTAMP:${formatICS(new Date())}
DTSTART:${e.start}
DTEND:${e.end}
SUMMARY:${e.title}
DESCRIPTION:${e.description}
LOCATION:${e.location}
BEGIN:VALARM
TRIGGER:-PT${e.reminder}M
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
END:VEVENT
END:VCALENDAR`;
}

function downloadICS() {
  const e = getEventData();
  const blob = new Blob([buildICS(e)], { type: "text/calendar" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = `${e.title.replace(/\s+/g,"_")}.ics`;
  a.click();
}

function openGoogle() {
  const e = getEventData();
  const url = `https://calendar.google.com/calendar/render?action=TEMPLATE` +
    `&text=${encodeURIComponent(e.title)}` +
    `&dates=${e.start}/${e.end}` +
    `&details=${encodeURIComponent(e.description)}` +
    `&location=${encodeURIComponent(e.location)}`;

  window.open(url, "_blank");
}

let currentQRUrl = "";

function makeQR() {
  const e = getEventData();
  const googleURL = `https://calendar.google.com/calendar/render?action=TEMPLATE` +
    `&text=${encodeURIComponent(e.title)}` +
    `&dates=${e.start}/${e.end}` +
    `&details=${encodeURIComponent(e.description)}` +
    `&location=${encodeURIComponent(e.location)}`;

  currentQRUrl = googleURL;

  const qrImageURL =
    `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(googleURL)}`;

  document.getElementById("qrcode").innerHTML =
    `<img id="qrImage" src="${qrImageURL}" width="220">`;
}

function downloadQR() {
  const img = document.getElementById("qrImage");
  if (!img) {
    alert("Generate QR first.");
    return;
  }

  const link = document.createElement("a");
  link.href = img.src;
  link.download = "event-qr.png";
  link.click();
}

async function shareEvent() {
  const e = getEventData();
  const shareURL = `https://calendar.google.com/calendar/render?action=TEMPLATE` +
    `&text=${encodeURIComponent(e.title)}` +
    `&dates=${e.start}/${e.end}` +
    `&details=${encodeURIComponent(e.description)}` +
    `&location=${encodeURIComponent(e.location)}`;

  if (navigator.share) {
    try {
      await navigator.share({
        title: e.title,
        text: "Add this event to your calendar:",
        url: shareURL
      });
    } catch (err) {
      console.log("Share cancelled");
    }
  } else {
    alert("Sharing not supported on this device.");
  }
}

document.getElementById("eventForm").addEventListener("submit", function(e) {
  e.preventDefault();
  downloadICS();
});

</script>

</body>
</html>
